(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-705921ea","chunk-36171fd5"],{"0454":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"模块"}},[a("a-select",{attrs:{placeholder:"请选择",options:e.options},model:{value:e.queryParam.moduleCode,callback:function(t){e.$set(e.queryParam,"moduleCode",t)},expression:"queryParam.moduleCode"}})],1)],1),a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"版本号"}},[a("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.versionNumber,callback:function(t){e.$set(e.queryParam,"versionNumber",t)},expression:"queryParam.versionNumber"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"发布状态"}},[a("a-select",{attrs:{placeholder:"请选择","default-value":"0"},model:{value:e.queryParam.publishStatus,callback:function(t){e.$set(e.queryParam,"publishStatus",t)},expression:"queryParam.publishStatus"}},[a("a-select-option",{attrs:{value:0}},[e._v("全部")]),a("a-select-option",{attrs:{value:1}},[e._v("未发布")]),a("a-select-option",{attrs:{value:2}},[e._v("已发布")])],1)],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")])],1)]),a("a-col",{attrs:{md:4,sm:24,offset:2}},[a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right"}},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加新版本")])],1)])],1)],1)],1),a("create-form",{ref:"createModal",attrs:{visible:e.visible,loading:e.confirmLoading,model:e.mdl},on:{cancel:e.handleCancel,ok:e.handleOk}}),a("a-table",{attrs:{columns:e.columns,"data-source":e.loadData,pagination:e.pagination,rowKey:"index",loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"status",fn:function(t){return a("span",{staticStyle:{color:"#007aff"}},[e._v(e._s(2==t?"已发布":"未发布"))])}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.onEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.onPublish(n)}}},[e._v(e._s(1===n.appUpdateStatus?"发布":"撤销"))]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定要删除该记录?"},on:{confirm:function(){return e.onDelete(n)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])],1)}}])})],1)],1)},r=[],o=a("5530"),i=(a("159b"),a("c1df"),a("0fea")),s=a("5c46"),l=[{title:"编号",dataIndex:"index",scopedSlots:{customRender:"serial"}},{title:"App版本名称",dataIndex:"appVersionName"},{title:"App版本号",dataIndex:"appVersionNumber"},{title:"更新时间",dataIndex:"appUpdateDate",sorter:!0},{title:"发布状态",dataIndex:"appUpdateStatus",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],u={name:"TableList",components:{CreateForm:s["default"]},data:function(){return this.columns=l,{visible:!1,confirmLoading:!1,mdl:null,queryParam:{pageIndex:1,pageSize:10,moduleCode:"",versionNumber:"",publishStatus:0},loadData:[],pagination:{showTotal:function(e){return"共".concat(e,"条记录")}},loading:!1,options:[{title:"前端",key:"disaster-application-phablet"}]}},filters:{},created:function(){this.getData()},computed:{},methods:{getData:function(){var e=this;this.loading=!0,Object(i["l"])(this.queryParam).then((function(t){if(1e4===t.code){e.loading=!1,t.data.forEach((function(e,t){e.index=t+1}));var a=Object(o["a"])({},e.pagination);a.total=t.totalNum,e.loadData=t.data,e.pagination=a}}))},handleTableChange:function(e,t,a){var n=Object(o["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.queryParam.pageIndex=e.current,this.getData()},onSearch:function(){this.getData()},handleAdd:function(){this.mdl=null,this.visible=!0},onEdit:function(e){this.visible=!0,this.mdl={versionName:e.appVersionName,versionNumber:e.appVersionNumber,moduleCode:e.appModuleCode,fileKey:e.appFileKey,versionId:e.appVersionId}},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(a,n){a?e.confirmLoading=!1:n.versionId>0?Object(i["p"])(n).then((function(a){1e4===a.code?(e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.getData(),e.$message.success("修改成功")):e.$message.error(a.info)})):(delete n.versionId,Object(i["n"])(n).then((function(a){1e4===a.code?(e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.getData(),e.$message.success("添加成功")):e.$message.error(a.info)})))}))},handleCancel:function(){this.visible=!1;var e=this.$refs.createModal.form;e.resetFields()},onPublish:function(e){var t=this;Object(i["q"])({versionId:e.appVersionId,publishStatus:1==e.appUpdateStatus?2:1}).then((function(e){1e4===e.code&&(t.$message.success("发布成功"),t.getData())}))},onDelete:function(e){var t=this;Object(i["o"])({versionId:e.appVersionId}).then((function(e){1e4===e.code?(t.$message.success("删除成功！"),t.getData()):t.$message.error("删除失败！")}))}}},c=u,d=a("2877"),p=Object(d["a"])(c,n,r,!1,null,null,null);t["default"]=p.exports},"0fea":function(e,t,a){"use strict";a.d(t,"l",(function(){return i})),a.d(t,"n",(function(){return s})),a.d(t,"q",(function(){return l})),a.d(t,"p",(function(){return u})),a.d(t,"o",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"e",(function(){return f})),a.d(t,"j",(function(){return m})),a.d(t,"g",(function(){return h})),a.d(t,"a",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"d",(function(){return g})),a.d(t,"b",(function(){return y})),a.d(t,"k",(function(){return j})),a.d(t,"i",(function(){return O})),a.d(t,"h",(function(){return w}));var n=a("b775"),r=a("0f22"),o={version:"/app/version/page/list",versionAdd:"/app/version/add",versionPublish:"/app/version/publish",versionModify:"/app/version/modify",versionDel:"/app/version/del",fileToken:"/minio/file/token",fileUpload:"/minio/file/upload",areaTree:"/area/code/tree",pointList:"/disaster/point/page/list",option:"/option/page/list",optionAdd:"/option/add",optionItems:"/option/items",optionModify:"/option/modify",optionDel:"/option/del",user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree"};function i(e){return Object(n["b"])({url:r["a"]+o.version,method:"post",data:e})}function s(e){return Object(n["b"])({url:r["a"]+o.versionAdd,method:"post",data:e})}function l(e){return Object(n["b"])({url:r["a"]+o.versionPublish,method:"post",data:e})}function u(e){return Object(n["b"])({url:r["a"]+o.versionModify,method:"post",data:e})}function c(e){return Object(n["b"])({url:r["a"]+o.versionDel,method:"post",data:e})}function d(e){return Object(n["b"])({url:r["a"]+o.fileToken,method:"post",data:e})}function p(e){return Object(n["b"])({url:r["a"]+o.fileUpload,method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function f(e){return Object(n["b"])({url:r["a"]+o.areaTree,method:"post",data:e})}function m(e){return Object(n["b"])({url:r["a"]+o.pointList,method:"post",data:e})}function h(e){return Object(n["b"])({url:r["a"]+o.option,method:"post",data:e})}function b(e){return Object(n["b"])({url:r["a"]+o.optionAdd,method:"post",data:e})}function v(e){return Object(n["b"])({url:r["a"]+o.optionItems,method:"post",data:e})}function g(e){return Object(n["b"])({url:r["a"]+o.optionModify,method:"post",data:e})}function y(e){return Object(n["b"])({url:r["a"]+o.optionDel,method:"post",data:e})}function j(e){return Object(n["c"])({url:o.role,method:"get",params:e})}function O(e){return Object(n["c"])({url:o.permissionNoPager,method:"get",params:e})}function w(e){return Object(n["c"])({url:o.orgTree,method:"get",params:e})}},"5c46":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.model&&e.model.versionId>0?"修改版本信息":"添加新版本",width:640,visible:e.visible,confirmLoading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"主键ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["versionId",{initialValue:0}],expression:"['versionId', { initialValue: 0 }]"}],attrs:{disabled:""}})],1),a("a-form-item",{attrs:{label:"app模块"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["moduleCode",{rules:[{required:!0,message:"请选择一项！"}]}],expression:"['moduleCode',{rules: [{required: true, message: '请选择一项！'}]}]"}],attrs:{placeholder:"请选择",options:e.options}})],1),a("a-form-item",{attrs:{label:"App版本名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["versionName",{rules:[{required:!0,min:1,message:"请输入App版本名称！"}]}],expression:"['versionName', {rules: [{required: true, min: 1, message: '请输入App版本名称！'}]}]"}]})],1),a("a-form-item",{attrs:{label:"App版本号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["versionNumber",{rules:[{required:!0,min:1,message:"请输入App版本号！"}]}],expression:"['versionNumber', {rules: [{required: true, min: 1, message: '请输入App版本号！'}]}]"}]})],1),a("a-form-item",{attrs:{label:"fileKey"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["fileKey",{rules:[{required:!0,min:1,message:"请上传文件"}]}],expression:"['fileKey', {rules: [{required: true, min: 1, message: '请上传文件'}]}]"}],attrs:{disabled:"",placeholder:"请上传文件"}})],1),a("a-form-item",{attrs:{label:"上传文件"}},[a("a-upload",{attrs:{name:"file",customRequest:e.customRequest,beforeUpload:e.beforeUpload,accept:".apk",fileList:e.fileList,remove:e.handleRemove},on:{change:e.handleChange}},[a("a-button",{attrs:{loading:e.uploading}},[a("a-icon",{attrs:{type:"upload"}}),e._v("上传APP ")],1)],1)],1)],1)],1)],1)},r=[],o=(a("b0c0"),a("88bc")),i=a.n(o),s=a("0fea"),l=["versionName","versionNumber","moduleCode","fileKey","versionId"],u={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),options:[{title:"前端",key:"disaster-application-phablet"}],fileKey:"",fileList:[],uploading:!1}},created:function(){var e=this;l.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(i()(e.model,l))}))},methods:{getFileKey:function(e){return Object(s["f"])({fileName:e,fileType:1,fileBucket:"apk",suffix:".apk"})},beforeUpload:function(e){this.fileList[0]=e,this.fileList.length=1},handleRemove:function(){this.fileList=[]},customRequest:function(e){var t=this;this.uploading=!0,this.getFileKey(e.file.name).then((function(a){if(1e4===a.code){t.fileKey=a.data.fileKey,t.form.setFieldsValue({fileKey:a.data.fileKey});var n=new FormData;n.append("file",e.file),n.append("fileKey",a.data.fileKey),Object(s["m"])(n).then((function(e){1e4===e.code?(t.uploading=!1,t.$message.success(e.info)):t.$message.error(e.info)}))}}))},handleChange:function(e){setTimeout((function(){e.file.status="done"}),1e3),e.file.status,"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))}}},c=u,d=a("2877"),p=Object(d["a"])(c,n,r,!1,null,null,null);t["default"]=p.exports},"88bc":function(e,t,a){(function(t){var a=1/0,n=9007199254740991,r="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",s="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,c=l||u||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function p(e,t){var a=-1,n=e?e.length:0,r=Array(n);while(++a<n)r[a]=t(e[a],a,e);return r}function f(e,t){var a=-1,n=t.length,r=e.length;while(++a<n)e[r+a]=t[a];return e}var m=Object.prototype,h=m.hasOwnProperty,b=m.toString,v=c.Symbol,g=m.propertyIsEnumerable,y=v?v.isConcatSpreadable:void 0,j=Math.max;function O(e,t,a,n,r){var o=-1,i=e.length;a||(a=q),r||(r=[]);while(++o<i){var s=e[o];t>0&&a(s)?t>1?O(s,t-1,a,n,r):f(r,s):n||(r[r.length]=s)}return r}function w(e,t){return e=Object(e),x(e,t,(function(t,a){return a in e}))}function x(e,t,a){var n=-1,r=t.length,o={};while(++n<r){var i=t[n],s=e[i];a(s,i)&&(o[i]=s)}return o}function k(e,t){return t=j(void 0===t?e.length-1:t,0),function(){var a=arguments,n=-1,r=j(a.length-t,0),o=Array(r);while(++n<r)o[n]=a[t+n];n=-1;var i=Array(t+1);while(++n<t)i[n]=a[n];return i[t]=o,d(e,this,i)}}function q(e){return C(e)||I(e)||!!(y&&e&&e[y])}function N(e){if("string"==typeof e||_(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function I(e){return A(e)&&h.call(e,"callee")&&(!g.call(e,"callee")||b.call(e)==r)}var C=Array.isArray;function $(e){return null!=e&&P(e.length)&&!D(e)}function A(e){return L(e)&&$(e)}function D(e){var t=S(e)?b.call(e):"";return t==o||t==i}function P(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function S(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function L(e){return!!e&&"object"==typeof e}function _(e){return"symbol"==typeof e||L(e)&&b.call(e)==s}var F=k((function(e,t){return null==e?{}:w(e,p(O(t,1),N))}));e.exports=F}).call(this,a("c8ba"))}}]);